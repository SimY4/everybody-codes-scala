package everybody.codes.y2025

object Quest6:

  def solve(input: String): Int =
    val (_, res) = input
      .foldLeft(0 -> 0):
        case ((count, res), 'A') => (count + 1, res)
        case ((count, res), 'a') => (count, res + count)
        case ((count, res), _)   => (count, res)
    res

  def solve2(input: String): Int =
    val (_, res) = input
      .foldLeft(Map.empty[Char, Int] -> Map.empty[Char, Int]):
        case ((count, res), ch) if ch.isUpper => (count.updated(ch, count.getOrElse(ch, 0) + 1), res)
        case ((count, res), ch)               =>
          (count, res.updated(ch, count.getOrElse(ch.toUpper, 0) + res.getOrElse(ch, 0)))
    res.values.sum

  def solve3(input: String): Int =
    (0 until input.length * 1000)
      .filter(i => input(i % input.length).isLower)
      .map: i =>
        val ch = input(i % input.length)
        ((0 max i - 1000) to (input.length * 1000 min i + 1000)).count: j =>
          input(j % input.length) == ch.toUpper
      .sum

  val input = "ABCAcBcCbaAabccCBBabcAbAABcAcCCACcBAAaCBbBcCcCBacCcbABbaAAcBABBaabCaBCBbbAAcCCAcabbCbbaBbaAbAAcCaacB"

  val input2 =
    "ABCbCaCBbaCcBaabbcccaBBBbBACbaBacbCabCAbbbbaACaCbbBBabCaaBCCAcAabAAaccbABAbcAbABBbAbbbcbCCaaAbcabAAcACCCaBBaAaBBcCcCaBCbbAbbAacCCaBCccAaCAcBCbCCccbAbabaBccCACbCbcbCaBaAABbCbcbbBABCaCcacCBBaaAcCCABCCaBcAbaBcaBCAaaCCBCbCCcCCCaAAacBaCaaACbAABaaABBabbAAbbcCCAcabbcbBAbbBBAAcAacBbCCBCBabCcbBAACbaCacbABCbA"

  val input3 =
    "acbAabCcaccAcbacaBACAbabbbBbcAbABaBBBCbCAcaacaBcCCabbbCCBCAbccACcbCABabbabcABABBBBbBAaCbbaCcBABAabABAaaCaCBAbCBBCCAAbaABaBBCaCbCCbcBcBbaAcBCaCBABACbCBBbaABbACaCBacAAbbcAaABBCccaBACCCcbBcaBAbcBCACCbaaBCbBABaCbBAAbcbBAABBbbCbAcBcaBacAbbbcCababaCbCBCcCbBcABCcACbbbabCbACCcBCBBAcABBCccABcbBBcaBccBCAcBcBcaBbacBCAcBCBcaaCbBcBcACBcbBACCAAcCcCAbacbAacAbabACcccacCaAAAcBaCBCCAabBcbBbBcbACBABacACabbbAcABcABabCcCcbaccbCBaaAbCbAAcAcCcCcCbBbCACaaABbCaBBBCCAccbCcBBacAAbACABABBaAAACBCaACaCacBcCCCBBBbBacbaAbAaCBCAcBABcAbababBBbAcBCbaAbacaAbaAbcAbccbBbCCABABCCcAaaAAcBBAcbaAAbbAaABABAbACcbBccabCabcbbAbCBCAACCBcBAbccABCcBCBCCbcCBcBaCAabBaaaBaAbBCBacaaBacacBAbAcaCABaCBcaAcCabaacBcCBcbBCBaAAbccbBabbCCBaACAaACaAaBcCBCAbaCbCCABAaCCaBCaAAaBbcbCACCCbacaBCccaAcAacaCCAaaaACbBAaCAcBAbACBCbaBCbAcBcbCBBbcBABcabAAAAACCACBCbbccbacbcACcBBaCBcCaCbcaAbbcccbABccbcacBBaBcbaCaCCcBCAAbcaCaaBcACbcCaAcCABacccAbBCcbcabbCBAccaBabBAAAAcCBaACAbCcCcAbabCBBAAbaaacbcababcbCBabCBACaACAcaABcCacCAaBaAbAAabCCBccAbCCbCaaaAAbbAbBaaCbBcCCbCbcbAaaAAbaACBcaCcabcaaABCBBBAAbcAcbcBbCBBBBCCabAbccAcCCBACbABabcBaAbBAaacAacbbbBBacCBAbBbcCbbAaccCCbaccBaaCaCACBBbbBcbacaCAcCbbCCAbbaBacaAbbaABbbCCbcAaBAcbaAaccAabbcaCbbbBBBaaCbCAAbcaBCbaBaaCcbacAcaCCcCBCaaCCaabbAcbcbBACbcCacbbabABBbcCcBbbAAaaAbACCaBAaBaBCAAcAAbbAcBCBcabbBAacbaBcBCAAcBCcaBCbCcBABaAaCcabBACAcbbCbCbaAbbBBAaACBBCbbBaAaCBAcaaBBcABcBBACCBbccaAAaBaBBabBcBCBAbbBbbabbbaBCcABAbbCBCAbCcbCccaccacaAaCcacaCaCCbABCCCBcAcbcabbBCBBaCAAacCAabcBABcABAbAbabCcbAAaBbAaCccccaBCcABAacaCcAaACaababcbcACcbaaacabbbCcacabAbBBbbbabABaCCaAABBCCBBcBBBAcabBacAaABBcCaAbcBCbCaCABBCBcaBbbAabccAAAcbabcbBaABAaaACCcaCCBccCbbCccCabcbBCbaBCbBbABcCaACaACcbCbCcbaacABcaBcBBAbaBBBAbbCacAcbbBBBCbBcCABcBaCbabBaBcbAcaAcACCbBbABCAaaCbcAcbBBBbbCccBbabcacBBaaAbbcCAAaCcBBccCCccbCcbAAaCCABbBcaAcABAcCbCCBBaABcBAbBbcBCbcCBBcCaAbcabaCAAcbBccBcBCcaCCCBcbbBBCaAAcbCABcabaaccacBcbaAACbAbCCacbCCbAcABbcbCaABbccAbbBABCbcabaabBCbBbbcabCcBbAAaBCbacCcbcCBBaACcAbcABABAcCbACCaabBbabACBCbAabcAcaACbbBCABBaBacCcaCaCaaaaBbCbAaBaCBcCBcbBbbAcbaaCbBcccAbBbABCAAAcCACACBabCabaBAbBbCCBbCaCbBcBccBaCAbbaCCBCACCCcAbAbbabCAaCcCcAAcCcbAcaBAacabaCbBCBCBAccacaAcacCBacBabAAbbbbabCBCaabCcCaCaBCBABCBcBaCacABaCCBCaABcAAcBacaacbBcAAabaABCBCccCacAcaaACCBCAcabBbACAaaAAaCAbbAaacbCaabBCabCBaCaacAaBAbAaCcbabCaABBcCBbccaAaCcaBBbCAAabbCabCBabBcaBcbacAaccabbCCCBAaCcBCbCbAAbbAaABacaBaCBCCCCbBCCBcacACBCacBABcBbaabCBaCCAbcAbCAAbcbbcAAcCCBCcBbBbBccAAaCcbBaAcbAAbaaBaAAbCaBCaABAbbBccACAacaaCCbaaBaaaCCcacABbBaaCbBaAaBbbbbBaBcCaaaABccBcACCCcCcCbABBABaaaBaaAAAACCAAcCBbCCBbAcbAbbCAbcbBAbcCaCAbCBAbAaAcAcAcbccBCBACAccAaBbaBCABBcCCaCbabcAcAccBcBCBcbBABaACaBcbccCbAbCbBBBAccAaAccACABaBbCaaCaBCAbCAbbABCcBBABbaCcBAaCaaAbCBCaaaCCBcAAaaBaAbACcBABaACAbacACaABABcbCaACbbAbabbABaaacacBcbCbaCBcbCCBccCcBAccccAcbAcCAbBBAAbccbCCacAbAaCccAbBBabAccABaabCbcAabAaaBBAACBabbCbcBBAbCbbbaCBAcCbAcbBbaCAAaCCCBAcBABbbbCbaaCBbaAbaAACaBBBCbABbacBAccCaaBCCABCBAbaCcBccBaaaAbABAbCACbaccabacBCCbaBaBAaBCcaBcaAbcAbbbBbbBbcCbCccaABAaBAbabbbCCacAbACacCAbaCBBCbAAbABbbAcAcCbAbCcaabBBBaBBbCaCBaCAabcACAaBbbacbBCBaACBBacCaAbABcAccBBAACaaABBAaAaBBCBbccbcCcBBCABABcBbaBCaACaCcABBaBBCabCAcbACAaCbBAcaAabABAbacCccACCABBcACaCAaABBbbBaccCCBAaCabccABbBBbAaacACbbAaacABbcCAaacACBcAbcBacbbBbcbcBAAaBaBBcbaaaABAAaAaAbCCccACcABBACABCCCbcAABBabBCAbCAbCAcBAbaCaCcAaAabaABcAABACAcBaBCbbABAAcCcAAcCabAcbcCBACaCaaCaCBCcbaaacAbCCCBaBcCCABcbcAbbACaabCabCAAccbCCaABBcaAbcbbacabAcCACabABAbbCccacbACbcabBcccABBBBCbcbaaCBbaABaAbbbbaaAbbCcAAcbbACaacACbCBBcCAAaACCaBBAAAbBCcBCBAcBCcBabAAabcCbCABBAaaccBcacCbAcAAccaCbcAABaaCAbbCcAacBbaBBbABCabCAcAaCcBCcbCBCbcAbBBCaBBCcBbcbBaAcBAcAAAbBAbbCAcBBaCABCabaBacaACBCbaaacBBBcCBAbaBabbAaABaCcBBcbabCAbcbaBBCAaaacBBCBcbAcccaAAacBabbcbCAAbabbAcbBabCCBaacBCBCcCcABAAbcAcaBAAcBaBAAcABCCCbBcbBcBbcAbABCBABCCbabbBcaCBabBbBABbcAaBaAAcCaBBbBACAbBAcCAAbCAbcbbBcAaCAccAAAAaaCbacbBCBbCBbBacCaCBAbCbbbcAaaACcAcBABabcAaBaCBaBcBabAbBcAaacaBABcaaCaaccAbbCbCacBAbAAcaBCABaBBaCCbaCaAaAACCCaaBacCABbBCbBcCACccABBcACcBAbcCbabCBbCCBCaacbcAacaCacBaaAacBCCCbcCbBbaccCCCbCcBbccCBBbbcAbCCACACbCAAcCBBBCbcCAacAcbCacCAabbBaABACbabbBbcCAaACBABacAaCABBCBcCAabcbBcBaabCaabCAbaacBBCbacCCCAbBAaaAaBbCBAAabBCCCBbACbaACccBbcCbacbBAAcCaBbcCBbBACBabACAaAbaaACAabccBAACCACcaABCBbBacCaCCBBcAAABAcAcAacaaAbcaCAACbBacAAacabCaBBabAAcABbbaCabbBCccabAbCBBAccCbacccAccCCaaABBCcABaaBaBbabBcCABbccBAaAAaaBcccabcaAabCABBaAAcAaBababaACcaccCCaAaBBcBaaCcCAaCBCcBaCaaaCbbCaBCAaabAcCCACaCACAcbAccAbAcAcAcAbCCAabBCBaAccBAabaaBAbBBCABaCAbbBBbAaABABbaBbBAAcCBbCCacbacBaaBcbBaCcCCaAbBaBbBbbbCAabBCaaCcACBbBACbabBBbBCaBaCAAbCCAcbcaccAcacBCAcabBCaCcBBAbAacAaAaaCBabAAbBcABbbccAcbaBbBabCCBAcBaaAcBbCCBbcCaCaaCcBCBBABAACACBcbabaCcBBacbbaabaCBCcBcaAAACaCccCcbacacAaaABacacAbbacCAABbBCAcBcAAcaabcbAAcCBBabbbCCbBBbBBbBaaBcBCaacbCcabBcbccaCBaBCbAACAbbBcbbaBbAcbcacAABABABabbCbAaCcabBcCBABBCBABBAAaabaaBcAaAaaabCbBbcabaaCcccAAbccAbbaBbbcbbacaAbcabBabcBbBCCCBABBCBaAAaBAcbBAaCCcaACaaCacCCbCcbCcACaBcCAacBcCBCAbcAccbaCAcbcAabCcBcbBbcabBbAaCbcbbcbcAacbABbcbccAcabBAcacAabCcCaaAaCBBbcbbABAcbCabCBcAaaaCAAaAaaBAabcBcBaaAabCCABcCbBaBaBABcbacbAcABAaBBCAbCBaBcBBcAacCBcCbbAcBcbCbBAbCbCAAcCaBBBCAAACAacbAaCcBBCaAbaaCbAaAbccBBcAAABccABCcbCabBBAaccABbaBABCcCbBAbcCCcaaBbbcaaCbaCAaacCBBcCaBCAabCaCAaCCcaCCCAbaCaBaCbAcaAABCaCcCccBCBbcAAABaBcbbbabCaaccaBBcBaaAACAcbBBBcBcaCbcbBAacCCbCABAbAbbbccbaaAAaBabAABAbacBbCabbAAbBbAabACacCCACCcaBAbCbcAaaabacCabbCBbbBcAcACBcaBbcbbAaCCBBaBbBbaCaCACBCcAaAAbCcbaAbabbAbcACcCcBbBaCAabACACABACcABCCBccbCAbCBABACBbBCccBcBabCaCBAbBccaacACBBaaAaBCaCAaBaBBaaBcAbbBCBBCaAccACBaCccaAbAAaAaBcbACcBaBCaCcAAAAcBAcbCABbBCcbACcCACbABccACBCaBCAaCCAaccBBbCcbccbAcCaAcBaCabaCbAaBaACcaCCBBCaabCaCabBabAaABbCACccCAabCAbBAbcACCbBabbabCbACbcBCBBCCcbCAbAcBAcBBcAAcAaAAaCaBCBAABccCaAcabAcBBCABBbAaCAbccbBbcBCAABbAcCBCBAaBcCCACBbaaBaCcBBBBcBcbCbcACcCCaaACcBcabcCBcbCCACCaaAbCbACcaaaCacbBABBACaACBCBcCCcacBAcbABcaCbAaCCcBaCCaAbCBBaaCCcbcAacabcCcbcacAbBAaCcBbcACcAcacaAacbBCBabCcCBbCcAACCbacabcBAAbbCAACBCBCBBbcccaABbaCaBcBCCAbBacBbCbCCaAabBAaCcCBABACBbBAaAaABaBBabccCcabaabCaaAcbcACCbCBBaCAAabBCcbAccABAaCCaBaaCcBbbBcBcccCcaaAcAbBccacabaaAcabAabCcaCbbCCACbBBbBabCAcaCAcCbBcaCcAaAAabABcaBCCAcBBAacBaCBCCCBABccBaaBbaCccaaAAcaabaCCBBAcccBacAbbCaAbcacBbAABAbcBCbcAacCbabacBBBcBAcAACBabCBbCBaAbCAcCCcaabacAcAcBACbccABabbbcbbBcCbAbaCCbaccABcbCbaaCBbBCACaBbaabcBBbAbCaCcBAcCaACcabBAcacABaBBCAAAbBCCABCbBBBaccABBBAcCBBbbbCCcbacaCaACbABCCabABCBAAbBaCCbBCbCaCbAccABabAAcAaCccacbaACaBBaAaaCcbcCbcBaabbAaAcAAAacabaaaABBbaAAbbbBbaCbaAabAcAcbBABbBCbABcaBaABaAcBCbBCCCCCcBbbcABBCAabBcbbCABCbCCaaBbabbBaABbCbCCcACbcaabBacaaAbBbcBabAcBcbABcAcAbAcabACccBaCcBAbaAaBcccCbACCCbCAcaCAaACBBBAABBBbcbbAAcAcbcBaACcCBCCBbcbBbAccCCBaAcAbABcCaAACBbAACBaAaBBAbcbBCabCbaCABCacCAACCCbaCACabCabBaCBaBCcCCbcCaBABcCBcBBBbbbCCbacAaAcbCcCBcCCbbbCBaaaABABbbCCCAabcbCbacCbAaBcAcBccABaBAACaaBAaaBAaccBCccABcAcbBBAbAACCAbacacCcbacABAAaAcbAcbBAAbBBcbbbbabABbCaccCBaCaCCbaACCbbBbBBBbcCAAcBaAbcaBaAAabcCaaabCabcbbCbBACBbCaBcaBBBbACACcBABbBCcCbaCbbcbCCcBabBABBaacAcCcCaAAbacBCbbAACabCCcbbcbCAACBcaaAbCCaBCAaACAbAabBaBBabbCbBbbCaacCACCBBaCCCBaBbCaacCbCbaABCaAaccbBBcACcbaBaaBAbabCcBBcaAcbacAaCCaCBcbbbAAbcbabcAaacAbccCCABaCAaabAbcBbBAbbABbBCcccbaAccCbCBcaaccBABBcBbbACaabaaCBbbAaccaCaAaBACaacbaBCaaaCCAACAabAABBbccaccAbCCABcCBBcbcCcbcAccbbACcbAabaCAbCABaAAAccbACBCaCCacBBCbCBAbAAbACBbaCBCAaCACABcCaAacAcbabAbCAccaBacCABbCbCaBcCabcAbcaBAcbCAAbcCAbBbAabbACbaCAaAaCaBACbABcbbACaaaABbbccacAaAbCAaABabAACAAabaabBAbAcCaABcCaABBcAcCBaAAbbAAAaaaBBbCCCAABcBacAAaCbcccaabbbbaCAbbCbbCaBbabACbbCbCBACabBbCabBBbaAbCaccCcAcCaCbcCaAaBcbBbCabABbcbBbabAbcaaAbcbBBaAbBbBBBCaaBaBBCAACcAAcaAbAAAcaCCCCCCAcBACCcbabACbCaAbBcccbAbbCcccAAccbAAcBcabbBbbbBAcCbacAcCacbACAAacCcCAbacCaBaBbbCCCbBBbcCccaCcacabABacacAcBabBaBabcAAbAaCCCcBBCAbcbCccCABcBbCCAAaAABABAABABCBAaccCBccbcBacaAaABAbcabCaAaAAcbBBbbcBaBbabAcABbcBaBBbBCAcCbbbbcaCBCcBbcabBcbcabaABcaAaAcbcBcBBbBCBBCaCCabBabAAaaCaacbABAAccACaacbCaCAbbcAaCCcBbbaCaAcCCaCcAacCcCBaAaCbAAABcCAacBCABAcBbBCabbBBbBacAcABbbbCabAabAAaCcabCaCbbaaCAaBbCbcacbACaaaAABcaCBccbccccAcCacbaacABbBcacbCACbAaCCCAbBAABcABAAaCacbCaaAcCBcCaCBCaaCACCcaabAABABCcCaBCcaaCacAaacAbABbacAccBABACAaCcCCACAcbcAbCcCccacBAcACCcaacBCcBbcAbcABABBbcBaCaaaBCBcAaACbCBbabCaCbCbAAaAabBaBcbAAcaccaAccACCBCaabbcBBCbBAbAACbBabCBAacaBbcCCaaCCaAbbBbCcABaCbCCCbBABBCCBbbcbbcAaAbBccaaCAbbaCAbcbCcaAAcbAaAAcbCcAabaBccBbbccCCABCABaCbacbCbABBBaccAbCaAaacCABCbaaaCbccBBAcAcAbAAbCbCacBbbbBbacBcBbCAaAbaAAAAbbccCBccACBBbcccCCBBcccACaBbcCBcCCBbCcccBbBaCbCBaBbBaabaAccCCaCCabcAcbbBBCCBabbcCAcACBbcCaCABAcbBAacaCaAcBaaBAbbCCACcABCcaCCcbcAbcACBcAcBaCbBbBcBAACaABAAabBcBbBbcBCCcacbacBbabBAbAabBCaABbBaBBbBcccbCbABAabBACACBBbcabbCccaBCCccbBbcCcbaCBCCcAcabCcAbCCcaAaaBCbAaabCbBbAabBAbCbBcAAbcCccbCaCAcCcaCacbcAAcCBCbAABAcAcacbBccaABcACcBCAcAAAAACCbBbAabaAacACBCccBaAabAcBACcCbaCCbaBbABBbCaaacabCcBCaABCAAababbcbBaAbBCBcabaAaaAaCaaBCbaBBbcaaABAAaBCacCaabCabBAbaACBBcbAcAABACbCccAccBAAabbBAAaCCbaBcccbccbcbcCababbbAbBcaAACcbACabABbcAbAbCcAaCaBAcAabCbAbBcaABccccBbbbbAaCACbAcBCbcbCaAaCccCbABaccBcBACaAcCAaaaBbCAAacBCcbacabcbBAccCBACBBaaACBAbCaccABbBaAbBcbCAaCcaaccabcBBBCaBBCCcCbcACbABAAAaBCaacAcbBaaACABABbbbcaCCbACCaacBBBcaCBaaAAabAABbBCcCccaBABcaBaaCcbacacCbccCCaaACbcCBacBcaabbABBCBBBccbAbbBabCaaaCbAbBccCBAcabAcacAcCacCAacbCbAAABBbAACcbbaAcCABCbAcbBAccaACaabAcbBAcaaBbBbccAbAcAcaCABaCcCcacACBbCAcAACCbbCCBCbbaAAcBbCAbcBBbCabcBCcabbbcBCCAcbCCaCbCccbcAabbAAAbabcAcACcaaBcaAbCCABbCCcBcbbCacCaAbCcbAaAcabaaBBcCBBCcACacbaCBCBbaAaBCCcAbbaaaCCABaCcBacbBaACcCBbAaababAabbAacbCCBbCCacCbbCcbCCbCBABcabaAABBbcbAcCccaaCCacbaaAbCcCaBcccBbaCcCCBaaCAcbbACAABCCAaBCBCaacbcCCAaBacabcCaAAAaabBbaBAbbCCBBBcBBBbccABcACcabAcaCaCaCaCBCacaabBBbbAaCcbAaABaBCaCAbAbCAabBBbBBCBAAACAaAaAcCaBaAcbCacbabBBABbABcAaBBCbCACCCBCAcBcBCaBBAbCBcbbabaaaCBbcCABACCBbCbcCbCBBbACCaABaACCABbBAcaccAcAAAaCABAbbAcbCcCaBCCcBacBccCCCAccCBCBbCbaBBabAaBaBcaCabCBCabCBcAbBabaCccbcbACbccbaBCbCcCbAabcaCcBCBCaCCbCbaBBCCaaaAcaABacaAACabcccccCAaaAAABacacBaAbcAcCaCaBABaCcccccbcBcaaACCCcbCBaaaBcAcCCaAcaCCCbaBCBaCCbaABAcbbAAaBAcBaccAAaAbcacbccACabCBCbbaaCcABccaAcCBAAaAacacAbBACCbBaaBCBbaacAbcCCCBAAACccBaAAbaCCABbcaabbacBcCbcbaBaBcAaaaBbCAAAcBcbCCaaacCcACBBaccBBbCcAccaAACa"
